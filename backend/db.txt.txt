DROP VIEW MPS;
DROP VIEW MP;
DROP VIEW SP;
DROP TABLE MODELPRODUCT;
DROP TABLE STAFFPRODUCT;
DROP TABLE MODEL;
DROP TABLE STAFF;
DROP TABLE PRODUCT;

CREATE TABLE MODEL (
 MODELID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
 NAME VARCHAR(100),
 TYPE VARCHAR(100),
 M_PRODUCTNR VARCHAR(100),
 M_WARRANTY INT,
 M_LIFESPAN INT,
 M_IMAGE VARCHAR(500),
 M_TBIMAGE VARCHAR(500),
);

CREATE TABLE PRODUCT (
 PRODUCTID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
 SERIALNR VARCHAR(100),
 STATUS VARCHAR(100),
 P_PRODUCTNR VARCHAR(100),
 P_WARRANTY DATE,
 P_LIFESPAN DATE,
 P_PURCHASED DATE,
 P_DISPOSED DATE,
 COMMENT VARCHAR(MAX),
);

CREATE TABLE STAFF (
 STAFFID INT NOT NULL AUTO_INCREMENT PRIMARY KEY,
 NAME VARCHAR(100),
);

CREATE TABLE STAFFPRODUCT (
 FK_STAFFID INT NOT NULL,
 FK_PRODUCTID INT NOT NULL,
 PRIMARY KEY (FK_STAFFID, FK_PRODUCTID),
 FOREIGN KEY (FK_STAFFID) REFERENCES STAFF(STAFFID) ON DELETE CASCADE,
 FOREIGN KEY (FK_PRODUCTID) REFERENCES PRODUCT(PRODUCTID) ON DELETE CASCADE,
);


CREATE TABLE MODELPRODUCT (
 FK_MODELID INT NOT NULL,
 FK_PRODUCTID INT NOT NULL,
 PRIMARY KEY (FK_MODELID, FK_PRODUCTID),
 FOREIGN KEY (FK_MODELID) REFERENCES MODEL(MODELID),
 FOREIGN KEY (FK_PRODUCTID) REFERENCES PRODUCT(PRODUCTID) ON DELETE CASCADE,
);

CREATE VIEW MP AS SELECT * FROM MODEL INNER JOIN MODELPRODUCT ON MODEL.MODELID = MODELPRODUCT.FK_MODELID INNER JOIN PRODUCT ON PRODUCT.PRODUCTID = MODELPRODUCT.FK_PRODUCTID;
SELECT * FROM MP;

CREATE VIEW SP AS SELECT * FROM PRODUCT INNER JOIN STAFFPRODUCT ON STAFFPRODUCT.FK_PRODUCTID = PRODUCT.PRODUCTID INNER JOIN STAFF ON STAFFPRODUCT.FK_STAFFID = STAFF.STAFFID;
SELECT * FROM SP;

CREATE VIEW MPS AS SELECT MP.MODELID AS M_ID, MP.M_PRODUCTNR, MP.M_WARRANTY, MP.M_LIFESPAN, MP.M_IMAGE, MP.M_TBIMAGE, MP.PRODUCTID AS P_ID, MP.NAME AS P_NAME, MP.TYPE AS P_TYPE, MP.SERIALNR AS P_SERIALNR, MP.STATUS AS P_STATUS, MP.P_WARRANTY, MP.P_LIFESPAN, MP.P_PURCHASED, MP.P_DISPOSED, MP.COMMENT AS P_COMMENT , SP.STAFFID AS S_ID, SP.NAME AS S_NAME FROM MP INNER JOIN SP ON MP.PRODUCTID = SP.PRODUCTID;
